; ---------------------------------------------------------------------------

biff		struc ;	(sizeof=0x18, align=0x8, copyof_1) ; XREF: main+3E/w
					; main/r
a		dd ?			; XREF:	main+1E/w
b		dd ?			; XREF:	main+25/w
c		dq ?			; offset
d		dw ?			; XREF:	main+2C/w
e		db 3 dup(?)		; XREF:	main+32/w main+36/w ...
		db ? ; undefined
		db ? ; undefined
		db ? ; undefined
biff		ends


;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-38F3-7EE4-0C			    |
; |			    University of Illinois			    |
; +-------------------------------------------------------------------------+
;
; Input	SHA256 : 9C321C490BEEE249C7733521F29D49278E68FBC10BCA1A4E158022DD5AE847D1
; Input	MD5    : 46423876E123D9B03BF1573F8EAD97C5
; Input	CRC32  : 1FA7D13F

; File Name   :	/home/sdasgup3/Github/binary-decompilation/test/variable_recovery/test_2/Output/test_2.clang.o
; Format      :	ELF64 for x86-64 (Relocatable)
;
; Source File :	'test_2.c'

		.686p
		.mmx
		.model flat
.intel_syntax noprefix

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	byte public 'CODE' use64
		assume cs:_text
		assume es:nothing, ss:nothing, ds:_text, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl foo(int first, biff *baz)
		public foo
foo		proc near		; CODE XREF: main+4Ep

baz		= qword	ptr -20h
first		= dword	ptr -14h
bar		= dword	ptr -4

		push	rbp
		mov	rbp, rsp
		mov	[rbp+first], edi
		mov	[rbp+baz], rsi
		mov	eax, [rbp+first]
		add	eax, eax
		mov	[rbp+bar], eax
		mov	rax, [rbp+baz]
		mov	eax, [rax+4]
		add	[rbp+bar], eax
		mov	rax, [rbp+baz]
		movzx	eax, word ptr [rax+10h]
		cwde
		mov	edx, [rbp+bar]
		sub	edx, eax
		mov	rax, [rbp+baz]
		mov	[rax], edx
		mov	eax, [rbp+bar]
		pop	rbp
		retn
foo		endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl main(int argc, const char	**argv,	const char **envp)
		public main
main		proc near		; DATA XREF: .eh_frame:00000000000000D4o

argv		= qword	ptr -40h
argc		= dword	ptr -34h
m		= dword	ptr -24h
baz		= biff ptr -20h
var_8		= qword	ptr -8

		push	rbp
		mov	rbp, rsp
		sub	rsp, 40h
		mov	[rbp+argc], edi
		mov	[rbp+argv], rsi
		mov	rax, fs:28h
		mov	[rbp+var_8], rax
		xor	eax, eax
		mov	[rbp+baz.a], 4
		mov	[rbp+baz.b], 0FFFFFFFCh
		mov	[rbp+baz.d], 0Fh
		mov	[rbp+baz.e], 61h ; 'a'
		mov	[rbp+baz.e+1], 62h ; 'b'

loc_70:					; DATA XREF: .eh_frame:00000000000000F4o
		mov	[rbp+baz.e+2], 63h ; 'c'
		mov	byte ptr [rbp+baz+15h],	0
		lea	rax, [rbp+baz]
		mov	rsi, rax	; baz
		mov	edi, 0Bh	; first
		call	foo
		mov	[rbp+m], eax
		mov	eax, 0
		mov	rdx, [rbp+var_8]
		xor	rdx, fs:28h
		jz	short locret_A5
		call	__stack_chk_fail ; PIC mode
; ---------------------------------------------------------------------------

locret_A5:				; CODE XREF: main+68j
		leave

locret_A6:				; DATA XREF: .eh_frame:00000000000000D0o
					; .eh_frame:00000000000000F0o
		retn
main		endp

_text		ends

; ===========================================================================

; Segment type:	Zero-length
; Segment permissions: Read/Write
_data		segment	byte public 'DATA' use64
_data		ends

; ===========================================================================

; Segment type:	Zero-length
; Segment permissions: Read/Write
_bss		segment	byte public 'BSS' use64
_bss		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_eh_frame	segment	para public 'CONST' use64
		assume cs:_eh_frame
		;org 0B0h
		db  14h
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    1
		db  7Ah	; z
		db  52h	; R
		db    0
		db    1
		db  78h	; x
		db  10h
		db    1
		db  1Bh
		db  0Ch
		db    7
		db    8
		db  90h	; ê
		db    1
		db    0
		db    0
		db  1Ch
		db    0
		db    0
		db    0
		db  1Ch
		db    0
		db    0
		db    0
		dd offset locret_A6+0FFFFFE8Ah
		dd offset main
		db    0
		db  41h	; A
		db  0Eh
		db  10h
		db  86h	; Ü
		db    2
		db  43h	; C
		db  0Dh
		db    6
		db  71h	; q
		db  0Ch
		db    7
		db    8
		db    0
		db    0
		db    0
		db  1Ch
		db    0
		db    0
		db    0
		db  3Ch	; <
		db    0
		db    0
		db    0
		dd offset locret_A6+0FFFFFEA0h
		dd offset loc_70+1
		db    0
		db  41h	; A
		db  0Eh
		db  10h
		db  86h	; Ü
		db    2
		db  43h	; C
		db  0Dh
		db    6
		db    2
		db  6Ch	; l
		db  0Ch
		db    7
		db    8
		db    0
		db    0
_eh_frame	ends

; ===========================================================================

; Segment type:	Externs
; extern
		extrn _GLOBAL_OFFSET_TABLE_
		extrn __stack_chk_fail:near ; CODE XREF: main+6Ap


		end
